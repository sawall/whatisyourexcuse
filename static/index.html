<!DOCTYPE html>
<html lang="en" >

<head>
  <meta charset="UTF-8">
  <link rel="shortcut icon" type="image/x-icon" href="https://static.codepen.io/assets/favicon/favicon-8ea04875e70c4b0bb41da869e81236e54394d63638a1ef12fa558a4a835f1164.ico" />
  <link rel="mask-icon" type="" href="https://static.codepen.io/assets/favicon/logo-pin-f2d2b6d2c61838f7e76325261b7195c27224080bc099486ddd6dccb469b8e8e6.svg" color="#111" />
  <title>What's your excuse?</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">   
  <link href="https://fonts.googleapis.com/css?family=Crete+Round" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Permanent+Marker" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Sriracha" rel="stylesheet">
  <link href="/style.css" rel="stylesheet">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-127474610-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-127474610-1');
  </script>
</head>

<body translate="no" >
  <header>
    <div class="banner">VOTING EXCUSE GENERATOR</div>
  </header>
  <div class="wrapper">
    <div id="wye">
      <div id="frames"> </div>
    </div>
    <div class="links_to_things">
      <div class="resources">
        <div class="resource">
          <a href="https://www.rockthevote.org/register-to-vote/">
            get registered
          </a>
        </div>
        <div class="resource">
          <a href="https://www.headcount.org/voter-info/">
            how to vote
          </a>
        </div>
        <div class="resource">
          <a href="https://www.rockthevote.org/resources/election-reminders/">
            get reminders
          </a>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
    <div id="share">
      <div id="links">
        <p><a href="mailto:whatisyourexcuse.vote@gmail.com" title="Are we missing an excuse? Send us an email!">Submit an excuse</a>
        <span id="credits">
          credits: we are just some people, ya know?  
        </span></p>
      </div>
    </div>
  </div>
  
  <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js'></script>
  <script src='/memes.js'></script>
  <script src='/memeframes.js'></script>
  <script>
    var quips = [];
    quips[0] = "Yeah, AND?";

    var cursor = 1 + Math.floor((excuse.length - 1)*Math.random());
    var frames = $('#frames');
    var current_meme, old_meme;
    
    function build_meme(excuse, meme, alt, footnote, info, quip) {
      return `<div class="frame future">
                ${ (excuse => {
                  if(excuse) return `<div class="excuse">"${excuse}"</div>`
                  else return ``
                 })(excuse) }
                <div class="meme">
                  <img src="/img/${meme}" alt="${alt}">
                </div>
                <div class="footnote">${footnote}</div>
                <div>
                ${ (info => {
                  if(info) return `<a href="${info}" class="quip" target="_blank">Tell me more!</a>`
                  else return ``
                 })(info) }
                  <a href="javascript:void(0);" class="quip">${quip}</a>
                </div>
              </div>`;
    }

    // first meme
    var memeNum = parseInt(window.location.hash.substr(1), 10);
    if (memeNum) {
        current_meme = $(build_meme(excuse[memeNum], meme[memeNum], alt[memeNum],
            footnotes[memeNum], info[memeNum], quips[0])).appendTo(frames);
    } else {
        current_meme = $(build_meme(excuse[0], meme[0], alt[0], footnotes[0],
            "", "I've got a great excuse!")).appendTo(frames);
    }
    current_meme.removeClass('future');				

    function next_meme(){
      cursor = (cursor >= excuse.length -1) ? 1 : cursor + 1;
      old_meme = current_meme;
      current_meme = $(build_meme(excuse[cursor], meme[cursor], alt[cursor], footnotes[cursor],
                       info[cursor], quips[Math.floor(Math.random()*quips.length)])).appendTo(frames);
      old_meme.addClass('past');
      setTimeout(function(){
        current_meme.removeClass('future');				
        setTimeout(function(){ old_meme.remove(); }, 600);
      }, 200);
    }
  
    $('#frames').delegate('a.quip', 'click', function(){
      next_meme();
    });
  </script>
</body>
</html>
